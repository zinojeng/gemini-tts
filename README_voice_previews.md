# 語音預覽功能說明

## 概述

Gemini TTS 應用程式現在支援兩種語音預覽方式：

1. **預先生成的檔案**：優先使用存放在 `voice_previews/` 目錄中的預先生成檔案
2. **即時生成**：如果沒有預先生成的檔案，則即時生成並快取

## 預先生成檔案的優勢

- **零延遲播放**：檔案已經存在，點擊即可播放
- **節省 API 配額**：不需要每次都調用 API
- **離線可用**：即使沒有網路連接也能預覽語音
- **部署友好**：可以將預覽檔案包含在部署包中

## 檔案命名規則

預覽檔案存放在 `voice_previews/` 目錄中，命名格式為：
```
preview_{語音名稱}_{語言代碼}.wav
```

例如：
- `preview_Zephyr_zh-TW.wav`
- `preview_Puck_en-US.wav`

## 生成預覽檔案

### 方法一：使用批量生成腳本

運行 `generate_all_voice_previews.py` 來生成所有語音和語言的預覽：

```bash
python generate_all_voice_previews.py
```

這個腳本會：
- 生成 30 個語音 × 5 個主要語言 = 150 個預覽檔案
- 跳過已存在的檔案
- 顯示生成進度
- 自動處理 API 速率限制

### 方法二：使用測試腳本

運行 `test_pregenerated_previews.py` 來生成少量測試用的預覽：

```bash
python test_pregenerated_previews.py
```

這個腳本只會生成 3 個語音的中英文預覽，適合測試用途。

## 整合到應用程式

`voice_preview_widget.py` 已經更新，會自動：

1. 首先檢查 `voice_previews/` 目錄中是否有預先生成的檔案
2. 如果有，直接播放該檔案
3. 如果沒有，則使用原有的即時生成和快取機制

## 部署建議

1. **開發環境**：可以只生成常用的幾個語音預覽
2. **生產環境**：建議預先生成所有語音預覽，並包含在部署包中
3. **GitHub 存儲**：可以將預覽檔案提交到 Git 倉庫，或使用 Git LFS 管理

## 注意事項

- 預覽檔案大小約 250KB 每個
- 150 個檔案總計約 37.5MB
- 建議使用 Git LFS 來管理這些二進制檔案
- API 有每日配額限制，生成時可能需要分批進行 